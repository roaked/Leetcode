"""Given an array of integers arr, find the sum of min(b), where b ranges over every (contiguous) subarray of arr.
 Since the answer may be large, return the answer modulo 109 + 7."""

from typing import List

class Solution:
    def sumSubarrayMins(self, arr: List[int]) -> int:
        dp = []
        mod = 10**9 + 7
        for i in range(len(arr)):
            for j in range(i, len(arr)):
                if i == j:
                    dp.append(arr[i])
                else: 
                    ans = arr[i:j+1]
                    dp.append(min(ans))
        return sum(dp) % mod
    
print(Solution().sumSubarrayMins(arr = [3,1,2,4]))
print(Solution().sumSubarrayMins(arr = [11,81,94,43,3]))
print(Solution().sumSubarrayMins(arr = [39,108,118,229,241,315,507,523,644,699,749,829,841,921,1072,1138,
                                        1175,1238,1341,1479,1542,1609,1651,1693,1799,1847,1888,1915,1979,
                                        2007,2028,2062,2068,2153,2205,2217,2273,2283,2347,2404,2485,2549,
                                        2654,2715,2813,2831,2866,2905,2931,2947,2988,3033,3061,3136,3246,
                                        3287,3381,3446,3512,3528,3630,3690,3714,3746,3820,3841,3894,3913,
                                        3972,3995,4023,4042,4137,4302,4364,4492,4535,4592,4699,4849,4882,
                                        4913,4972,5119,5151,5214,5279,5322,5360,5565,5699,5709,5757,5835,
                                        5899,5953,6109,6144,6207,6400,6523,6550,6615,6655,6702,6794,6814,
                                        6879,6900,6910,6996,7027,7062,7132,7254,7261,7340,7439,7484,7567,
                                        7586,7630,7726,7791,7998,8027,8118,8237,8290,8324,8327,8361,8377,
                                        8428,8488,8492,8507,8535,8586,8609,8630,8687,8808,8891,8956,8990,
                                        9038,9156,9256,9355,9378,9454,9467,9582,9614,9675,9693,9737,9785,
                                        9802,9837,9919,9939,9960,9987,10077,10091,10139,10276,10336,10409,
                                        10424,10507,10601,10755,10843,10890,10946,11071,11141,11155,11210,
                                        11338,11383,11418,11546,11564,11598,11671,11707,11817,11898,11946,
                                        11972,12112,12127,12170,12175,12252,12278,12336,12387,12401,12436,
                                        12469,12518,12583,12671,12728,12741,12810,12832,12964,13038,13105,
                                        13122,13195,13220,13251,13439,13631,13660,13737,13792,13858,13881,
                                        13937,13998,14024,14135,14183,14249,14274,14347,14420,14514,14562,
                                        14599,14701,14752,14820,14838,14848,14887,14976,15056,15132,15159,
                                        15227,15287,15317,15333,15342,15361,15465,15483,15734,15777,15808,
                                        15884,16061,16109,16134,16217,16298,16327,16336,16420,16440,16488,
                                        16609,16716,16750,16795,16825,16961,17028,17072,17122,17142,17163,
                                        17222,17246,17303,17322,17385,17492,17540,17571,17632,17641,17752,
                                        17819,17876,17895,18079,18107,18158,18200,18273,18312,18386,18415,
                                        18424,18505,18564,18643,18688,18701,18833,18855,18887,19067,19166,
                                        19214,19293,19455,19458,19532,19584,19665,19715,19831,19865,19906,
                                        19948,19968,19983,20033,20042,20061,20116,20223,20296,20388,20444,
                                        20556,20579,20615,20654,20770,20843,20881,20907,21025,21083,21118,
                                        21301,21392,21454,21531,21584,21626,21715,21780,21810,21825,21863,
                                        21952,21970,22010,22062,22140,22172,22206,22253,22321,22325,22344,
                                        22378,22437,22512,22542,22597,22658,22713,22823,22826,22897,22901,
                                        22949,23015,23068,23094,23160,23359,23382,23442,23496,23524,23589,
                                        23616,23675,23693,23765,23787,23916,23925,24070,24082,24122,24166,
                                        24182,24192,24221,24298,24325,24403,24470,24488,24507,24596,24663,
                                        24733,24787,24827,24863,24957,24986,25018,25038,25114,25155,25205,
                                        25254,25288,25303,25344,25392,25423,25503,25548,25639,25702,25742,
                                        25815,25871,25985,26046,26089,26135,26201,26241,26271,26293,26414,
                                        26567,26582,26640,26729,26776,26833,26863,26936,27058,27142,27219,
                                        27384,27425,27518,27551,27571,27626,27762,27801,27858,27878,27937,
                                        27952,27978,27994,28049,28071,28151,28281,28315,28393,28436,28478,
                                        28567,28587,28677,28690,28805,28851,28865,28993,29053,29100,29114,
                                        29154,29341,29559,29605,29635,29664,29741,29810,29858,29948,29976,
                                        29936,29820,29749,29724,29662,29623,29600,29413,29181,29137,29111,
                                        29068,29019,28934,28857,28839,28753,28688,28664,28581,28518,28458,
                                        28415,28366,28297,28223,28124,28067,28007,27980,27967,27944,27936,
                                        27877,27834,27763,27633,27587,27567,27542,27507,27408,27221,27143,
                                        27098,26952,26884,26845,26792,26769,26675,26627,26580,26416,26390,
                                        26293,26248,26239,26144,26114,26059,26002,25910,25818,25768,25717,
                                        25644,25626,25526,25477,25407,25346,25305,25294,25282,25239,25160,
                                        25139,25041,25021,24993,24984,24934,24839,24811,24780,24709,24656,
                                        24539,24499,24483,24436,24378,24303,24271,24206,24189,24181,24154,
                                        24119,24073,23954,23919,23865,23766,23696,23680,23640,23602,23537,
                                        23511,23461,23425,23371,23215,23151,23082,23035,23002,22943,22899,
                                        22829,22824,22814,22691,22614,22593,22516,22485,22420,22371,22341,
                                        22323,22268,22207,22194,22141,22109,22058,21991,21957,21946,21862,
                                        21816,21807,21770,21691,21608,21549,21468,21450,21352,21276,21086,
                                        21080,20921,20896,20864,20824,20699,20622,20592,20561,20460,20401,
                                        20306,20250,20214,20092,20053,20035,20009,19969,19965,19914,19867,
                                        19834,19809,19708,19629,19551,19482,19456,19381,19244,19212,19109,
                                        18971,18882,18855,18809,18700,18668,18632,18528,18472,18417,18388,18315,18299,18252,18160,18132,18081,17920,17891,17852,17811,17704,17637,17609,17557,17525,17401,17369,17320,17267,17244,17200,17162,17126,17090,17035,17018,16950,16800,16772,16741,16636,16541,16477,16432,16343,16329,16306,16239,16215,16114,16092,16047,15849,15798,15764,15685,15481,15370,15342,15337,15323,15304,15260,15198,15155,15128,15035,14914,14864,14846,14833,14794,14751,14677,14592,14529,14422,14410,14338,14254,14196,14160,14134,14004,13963,13901,13871,13827,13740,13687,13643,13516,13422,13222,13220,13142,13113,13092,13032,12844,12819,12801,12733,12683,12595,12557,12475,12463,12426,12395,12350,12305,12252,12244,12171,12154,12118,12077,11952,11910,11885,11777,11674,11640,11565,11563,11494,11394,11357,11241,11193,11147,11117,10962,10895,10861,10833,10624,10580,10496,10424,10392,10282,10262,10094,10078,10035,9981,9946,9938,9838,9810,9797,9747,9718,9689,9668,9582,9545,9462,9379,9365,9267,9184,9071,9013,8979,8892,8826,8785,8651,8615,8601,8538,8535,8503,8489,8464,8424,8375,8345,8327,8310,8268,8131,8047,8016,7982,7782,7636,7616,7585,7496,7465,7408,7322,7260,7133,7084,7041,7004,6962,6903,6900,6860,6810,6792,6659,6621,6608,6527,6402,6246,6203,6113,6044,5908,5896,5762,5720,5704,5672,5493,5349,5303,5231,5180,5140,5000,4933,4893,4881,4818,4604,4544,4511,4426,4359,4215,4124,4036,4002,3988,3963,3903,3868,3839,3748,3743,3709,3643,3558,3516,3484,3432,3379,3251,3140,3134,3058,3011,2981,2934,2923,2884,2849,2825,2793,2663,2613,2504,2477,2377,2323,2275,2245,2207,2154,2148,2063,2030,2019,2005,1926,1912,1888,1802,1719,1688,1610,1603,1492,1371,1327,1208,1162,1096,947,846,832,791,729,645,568,522,489,285,241,121,109,59]))